---
# ====== Page: &APP_USER. ====================================
id: 900
identification: 
  name: '&APP_USER.'
  alias: USER
  title: User Profile
  page-group: USER_PROFILE # 18317012587086665

appearance: 
  page-mode: Normal
  page-template: Theme Default
  template-options: 
  - '#DEFAULT#'

navigation-menu: 
  override-user-interface-level: false

navigation: 
  cursor-focus: Do not focus cursor
  warn-on-unsaved-changes: true

css: 
  inline: |
    #BANNER {
        min-height: 12rem;
    }
    
    .a-CardView-items--row .has-media {
        grid-template-columns: 200px minmax(0,var(--a-cv-icon-spacer,44px)) 1fr minmax(0,auto);
    }
    .a-CardView-media--body {
        margin: 0;
    }
    .a-CardView-items--row .a-CardView-media {
        align-items: flex-start;
        background: transparent;
    }
    .a-CardView-mediaImg {
        border-radius: 8px;
    }
    .a-CardView-mainContent {
    }
    
    #PUSH_NOTIFICATIONS .t-Region-body {
        padding: 0 2rem 0.5rem 0.6rem;
    }
    

security: 
  authorization-scheme: IS_USER # 43462402185717150
  authentication: Page Requires Authentication
  deep-linking: Application Default
  page-access-protection: Arguments Must Have Checksum
  form-auto-complete: Off
  browser-cache: Application Default

session-management: 
  rejoin-sessions: Application Default

advanced: 
  enable-duplicate-page-submissions: Yes - Enable page to be re-posted
  reload-on-submit: Only for Success

server-cache: 
  caching: Disabled

help: 
  help-text: |
    On this page you can set your profile.
    - change your name and email address
    - change your avatar
    - see the roles you have been assigned on current app
    

regions: 
- # ====== Region: APPLICATION_ROLES ===========================
  id: 24620825912821111
  identification: 
    title: APPLICATION_ROLES
    type: Static Content

  layout: 
    sequence: 30
    parent-region: No Parent
    position: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 3

  appearance: 
    template: Blank with Attributes # 63325094538439079
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: User Profile [CARD] =========================
  id: 24621546834821118
  identification: 
    title: User Profile [CARD]
    type: Cards

  source: 
    location: Local Database
    type: Table / View
    table-owner: Parsing Schema
    table-name: APP_USERS
    include-rowid-column: false
    where-clause: user_id = core.get_user_id()

  order-by: 
    type: None

  layout: 
    sequence: 20
    parent-region: USER_PROFILE # 24622294394821125
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Cards Container # 63327898435439081
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    id: 24621670954821119
    appearance: 
      layout: Horizontal (Row)

    card: 
      primary-key-column-1: USER_ID

    title: 
      advanced-formatting: false
      column: USER_NAME

    subtitle: 
      advanced-formatting: false
      column: USER_TITLE

    body: 
      advanced-formatting: false
      column: USER_ABOUT

    secondary-body: 
      advanced-formatting: false

    icon-and-badge: 
      icon-source: No Icon

    media: 
      advanced-formatting: false
      source: BLOB Column
      blob-column: AVATAR_BLOB
      position: Body
      appearance: Auto
      sizing: Fit

    blob-attributes: 
      mime-type-column: AVATAR_MIME
      last-updated-column: UPDATED_AT

    performance: 
      lazy-loading: false

    pagination: 
      type: Scroll
      show-total-count: false

    actions: 
    - # ====== Action: MEDIA =======================================
      id: 24622444162821127
      identification: 
        type: Media

      layout: 
        sequence: 10

      link: 
        type: Redirect to Page in this Application
        target: 
          url: 'f?p=&APP_ID.:902:&SESSION.::&DEBUG.:902::'
          page: 902 # User Avatar
          clear-cache: 902

    - # ====== Action: FULL_CARD ===================================
      id: 24622587883821128
      identification: 
        type: Full Card

      layout: 
        sequence: 20

      link: 
        type: Redirect to Page in this Application
        target: 
          url: 'f?p=&APP_ID.:901:&SESSION.::&DEBUG.:901::'
          page: 901 # User Profile
          clear-cache: 901

- # ====== Region: User Profile ================================
  id: 24621758124821120
  identification: 
    title: User Profile
    type: Static Content

  layout: 
    sequence: 10
    parent-region: USER_PROFILE # 24622294394821125
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Hero # 63402598617439121
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: PUSH_NOTIFICATIONS ==========================
  id: 24621907041821122
  identification: 
    title: PUSH_NOTIFICATIONS
    type: Static Content

  layout: 
    sequence: 40
    parent-region: No Parent
    position: BODY
    start-new-layout: false
    start-new-row: false
    column: 11
    new-column: true
    column-span: 2

  appearance: 
    template: Blank with Attributes # 63325094538439079
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: PUSH_NOTIFICATIONS
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Push Notifications ==========================
  id: 24622108084821124
  identification: 
    title: Push Notifications
    type: Static Content

  layout: 
    sequence: 10
    parent-region: PUSH_NOTIFICATIONS # 24621907041821122
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Hero # 63402598617439121
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: USER_PROFILE ================================
  id: 24622294394821125
  identification: 
    title: USER_PROFILE
    type: Static Content

  layout: 
    sequence: 20
    parent-region: No Parent
    position: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 4

  appearance: 
    template: Blank with Attributes # 63325094538439079
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Push Notifications ==========================
  id: 48547233909047763
  identification: 
    title: Push Notifications
    type: Static Content

  source: 
    html-code: Push notifications have to be enabled for each device you want to receive the notifications on. The first time you enable push notifications, you will have to grant permission to your browser. This setting can be changed at any time.

  layout: 
    sequence: 30
    parent-region: PUSH_NOTIFICATIONS # 24621907041821122
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard # 63362861151439101
    template-options: 
    - '#DEFAULT#'
    - t-Region--removeHeader js-removeLandmark
    - t-Region--textContent
    - t-Region--scrollBody
    css-classes: 
    - a-pwaPush--subscriptionRegion
    icon: fa-bell-o
    render-components: Below Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Push Notifications Not Supported ============
  id: 48605859706387160
  identification: 
    title: Push Notifications Not Supported
    type: Static Content

  source: 
    html-code: Push notifications are not currently supported in your browser.

  layout: 
    sequence: 20
    parent-region: PUSH_NOTIFICATIONS # 24621907041821122
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard # 63362861151439101
    template-options: 
    - '#DEFAULT#'
    - t-Region--removeHeader js-removeLandmark
    - t-Region--textContent
    - t-Region--scrollBody
    css-classes: 
    - a-pwaPush--subscriptionRegion--not-supported
    icon: fa-bell-slash-o
    render-components: Below Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    custom-attributes: 
    - 'style="display:none;"'
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: BANNER ======================================
  id: 72401475894285964
  identification: 
    title: BANNER
    type: Static Content

  source: 
    html-code: |
      <h1>Good job, &G_USER_FIRST_NAME.</h1>
      

  layout: 
    sequence: 10
    parent-region: No Parent
    position: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Blank with Attributes # 63325094538439079
    template-options: 
    - '#DEFAULT#'
    render-components: Below Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: BANNER
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: App Roles ===================================
  id: 75653747485463881
  identification: 
    title: App Roles
    type: Static Content

  layout: 
    sequence: 10
    parent-region: APPLICATION_ROLES # 24620825912821111
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Hero # 63402598617439121
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: ROLES [CARDS] ===============================
  id: 75654026921463884
  identification: 
    title: ROLES [CARDS]
    type: Cards

  source: 
    location: Local Database
    type: Table / View
    table-owner: Parsing Schema
    table-name: APP_USER_ROLES_V
    include-rowid-column: false

  order-by: 
    type: None

  layout: 
    sequence: 20
    parent-region: APPLICATION_ROLES # 24620825912821111
    position: SUB_REGIONS
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Cards Container # 63327898435439081
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    id: 14562200093376435
    appearance: 
      layout: Grid
      grid-columns: 2 Columns

    card: 
      primary-key-column-1: ROLE_ID

    title: 
      advanced-formatting: false
      column: ROLE_NAME

    subtitle: 
      advanced-formatting: false
      column: ROLE_GROUP

    body: 
      advanced-formatting: false
      column: ROLE_DESC

    secondary-body: 
      advanced-formatting: false
      column: CONTEXT_ID

    icon-and-badge: 
      icon-source: No Icon

    media: 
      advanced-formatting: false
      source: No Media

    performance: 
      lazy-loading: false

    pagination: 
      type: Scroll
      show-total-count: false

page-items: 
- # ====== Page Item: P900_MESSAGE =============================
  id: 24149759321647510
  identification: 
    name: P900_MESSAGE
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 20
    region: Push Notifications # 48547233909047763
    position: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  default: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: "'TEST ' || TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS')"

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: false
    restricted-characters: All characters can be saved.

- # ====== Page Item: P900_ENABLE_PUSH =========================
  id: 48547984357047767
  identification: 
    name: P900_ENABLE_PUSH
    type: Checkbox

  label: 
    label: Enable on this device
    alignment: Left

  settings: 
    use-defaults: false
    checked-value: Y

  layout: 
    sequence: 10
    region: Push Notifications # 48547233909047763
    position: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional - Floating # 63461560868439163
    template-options: 
    - '#DEFAULT#'
    - margin-top-sm

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Ignore

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: false
    restricted-characters: All characters can be saved.

buttons: 
- # ====== Button: INSTALL =====================================
  id: 24149004790647503
  identification: 
    button-name: INSTALL
    label: Install

  layout: 
    sequence: 10
    region: Push Notifications # 48547233909047763
    position: CLOSE
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text with Icon # 63464158031439167
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--iconLeft
    icon: fa-cloud-download

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

- # ====== Button: SEND_TEST ===================================
  id: 24149324030647506
  identification: 
    button-name: SEND_TEST
    label: Send Test

  layout: 
    sequence: 20
    region: Push Notifications # 48547233909047763
    position: CLOSE
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text # 63463978601439167
    hot: false
    template-options: 
    - '#DEFAULT#'

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: SEND_TEST

- # ====== Button: EDIT_PROFILE ================================
  id: 24730493665693512
  identification: 
    button-name: EDIT_PROFILE
    label: Edit Profile

  layout: 
    sequence: 10
    region: User Profile # 24621758124821120
    position: RIGHT_OF_TITLE
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Icon # 63463317880439166
    hot: false
    template-options: 
    - '#DEFAULT#'
    icon: fa-clipboard-edit

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:901:&SESSION.::&DEBUG.:901::'
      page: 901 # User Profile
      clear-cache: 901

    warn-on-unsaved-changes: Do Not Check

dynamic-actions: 
- # ====== Dynamic Action: CHANGED_PROJECT =====================
  id: 14562952563376436
  identification: 
    name: CHANGED_PROJECT

  execution: 
    sequence: 10

  when: 
    event: EVENT.EVENT.BROWSER.CHANGE
    selection-type: Item(s)
    item(s): 
    - P900_PROJECT_ID

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Submit Page =================================
    id: 14563452990376438
    identification: 
      action: Submit Page

    settings: 
      show-processing: true

    execution: 
      sequence: 20
      event: CHANGED_PROJECT # 14562952563376436
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: INSTALL_PWA =========================
  id: 24149170987647504
  identification: 
    name: INSTALL_PWA

  execution: 
    sequence: 30

  when: 
    event: EVENT.EVENT.BROWSER.CLICK
    selection-type: Button
    button: INSTALL # 24149004790647503

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 24149244849647505
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: apex.pwa.openInstallDialog();

    execution: 
      sequence: 10
      event: INSTALL_PWA # 24149170987647504
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: SWITCH_PUSH_NOTIFICATIONS ===========
  id: 24279802208673720
  identification: 
    name: SWITCH_PUSH_NOTIFICATIONS

  execution: 
    sequence: 20

  when: 
    event: EVENT.EVENT.BROWSER.CHANGE
    selection-type: Item(s)
    item(s): 
    - P900_ENABLE_PUSH

  client-side-condition: 
    type: Item = Value
    item: P900_ENABLE_PUSH
    value: Y

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Subscribe to push notifications =============
    id: 24280231939673721
    identification: 
      name: Subscribe to push notifications
      action: Execute JavaScript Code

    settings: 
      code: apex.pwa.subscribePushNotifications();

    execution: 
      sequence: 10
      event: SWITCH_PUSH_NOTIFICATIONS # 24279802208673720
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Unsubscribe from push notifications =========
    id: 24280734870673721
    identification: 
      name: Unsubscribe from push notifications
      action: Execute JavaScript Code

    settings: 
      code: apex.pwa.unsubscribePushNotifications();

    execution: 
      sequence: 10
      event: SWITCH_PUSH_NOTIFICATIONS # 24279802208673720
      fire-when-event-result-is: False
      fire-on-initialization: false

- # ====== Dynamic Action: ON_MODAL_CLOSE ======================
  id: 24624722752821150
  identification: 
    name: ON_MODAL_CLOSE

  execution: 
    sequence: 40

  when: 
    event: EVENT.EVENT.FAMEWORK.APEXAFTERCLOSEDIALOG
    selection-type: JavaScript Expression
    javascript-expression: window

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Refresh =====================================
    id: 24729319809693501
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: User Profile [CARD] # 24621546834821118

    execution: 
      sequence: 10
      event: ON_MODAL_CLOSE # 24624722752821150
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Execute JavaScript Code =====================
    id: 24729464791693502
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: show_success('Profile updated');

    execution: 
      sequence: 20
      event: ON_MODAL_CLOSE # 24624722752821150
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: SEND_PUSH_NOTIFICATION ==============
  id: 24857865163145922
  identification: 
    name: SEND_PUSH_NOTIFICATION

  execution: 
    sequence: 50

  when: 
    event: EVENT.EVENT.BROWSER.CLICK
    selection-type: Button
    button: SEND_TEST # 24149324030647506

  execution: 
    event-scope: Static
    type: Immediate

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 24857985542145923
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        core.send_push_notification (
            in_title    => 'Test Notification',
            in_message  => 'Message created at ' || TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI'),
            in_asap     => TRUE
        );
        

    execution: 
      sequence: 10
      event: SEND_PUSH_NOTIFICATION # 24857865163145922
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Execute JavaScript Code =====================
    id: 24858030700145924
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        $('#SEND_TEST').blur();
        show_success('Push notification sent');
        
        

    execution: 
      sequence: 20
      event: SEND_PUSH_NOTIFICATION # 24857865163145922
      fire-when-event-result-is: True
      fire-on-initialization: false

computations: 
- # ====== Computation: P900_ENABLE_PUSH =======================
  id: 24619825594821101
  identification: 
    item-name: P900_ENABLE_PUSH

  execution: 
    sequence: 10
    point: Before Regions

  computation: 
    type: SQL Query (return single value)
    sql-query: |
      SELECT 'Y' AS is_active
      FROM apex_appl_push_subscriptions t
      WHERE t.application_id      = core.get_app_id()
          AND t.user_name         = core.get_user_id();

